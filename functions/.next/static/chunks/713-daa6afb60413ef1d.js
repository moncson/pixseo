"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[713],{206:function(e,t,r){r.d(t,{Z:function(){return d}});var n=r(7437),a=r(2265),i=r(7648),o=r(9376),s=r(6281),l=r(4114);function d(e){let{children:t}=e,r=(0,o.usePathname)(),d=(0,o.useRouter)(),{user:c}=(0,s.a)(),[u,h]=(0,a.useState)(!1),m=async()=>{try{await (0,l.w7)(),d.push("/admin/login")}catch(e){console.error("Sign out error:",e)}},b=[{name:"ダッシュボード",href:"/admin",icon:(0,n.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"})})},{name:"記事管理",href:"/admin/articles",icon:(0,n.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),subItems:[{name:"記事一覧",href:"/admin/articles"},{name:"新規記事",href:"/admin/articles/new"}]},{name:"カテゴリー管理",href:"/admin/categories",icon:(0,n.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-6l-2-2H5a2 2 0 00-2 2z"})})},{name:"タグ管理",href:"/admin/tags",icon:(0,n.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z"})})}];return(0,n.jsxs)("div",{className:"min-h-screen bg-gray-100",children:[(0,n.jsx)("header",{className:"fixed top-0 left-0 right-0 bg-white shadow-sm z-50",children:(0,n.jsxs)("div",{className:"flex justify-between items-center px-4 py-3",children:[(0,n.jsxs)("div",{className:"flex items-center",children:[(0,n.jsx)("button",{onClick:()=>h(!u),className:"p-2 rounded-md text-gray-600 hover:text-gray-900 hover:bg-gray-100 lg:hidden",children:(0,n.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})}),(0,n.jsx)(i.default,{href:"/admin",className:"ml-2 lg:ml-0 text-xl font-bold text-blue-600",children:"ふらっと。管理画面"})]}),(0,n.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,n.jsx)("span",{className:"hidden sm:block text-sm text-gray-600",children:null==c?void 0:c.email}),(0,n.jsx)("button",{onClick:m,className:"px-4 py-2 text-sm font-medium text-white bg-red-600 rounded-md hover:bg-red-700",children:"ログアウト"})]})]})}),(0,n.jsx)("aside",{className:"\n        fixed top-[57px] left-0 bottom-0 w-64 bg-white shadow-lg transform transition-transform duration-200 ease-in-out z-40\n        ".concat(u?"translate-x-0":"-translate-x-full","\n        lg:translate-x-0\n      "),children:(0,n.jsx)("nav",{className:"h-full overflow-y-auto py-4",children:b.map(e=>{let t=r===e.href||r.startsWith(e.href+"/");return(0,n.jsxs)("div",{children:[(0,n.jsxs)(i.default,{href:e.href,onClick:()=>h(!1),className:"\n                    flex items-center px-4 py-3 text-sm font-medium transition-colors\n                    ".concat(t?"bg-blue-50 text-blue-700 border-l-4 border-blue-700":"text-gray-700 hover:bg-gray-50 border-l-4 border-transparent","\n                  "),children:[(0,n.jsx)("span",{className:"mr-3",children:e.icon}),e.name]}),e.subItems&&t&&(0,n.jsx)("div",{className:"bg-gray-50",children:e.subItems.map(e=>(0,n.jsx)(i.default,{href:e.href,onClick:()=>h(!1),className:"\n                          flex items-center px-4 py-2 pl-14 text-sm transition-colors\n                          ".concat(r===e.href?"text-blue-700 font-medium":"text-gray-600 hover:text-gray-900","\n                        "),children:e.name},e.href))})]},e.name)})})}),u&&(0,n.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-30 lg:hidden",onClick:()=>h(!1)}),(0,n.jsx)("main",{className:"pt-[57px] lg:ml-64 min-h-screen",children:(0,n.jsx)("div",{className:"p-4 sm:p-6 lg:p-8",children:t})})]})}},4906:function(e,t,r){r.d(t,{Z:function(){return s}});var n=r(7437),a=r(2265),i=r(9376),o=r(6281);function s(e){let{children:t}=e,{user:r,loading:s}=(0,o.a)(),l=(0,i.useRouter)();return((0,a.useEffect)(()=>{s||r||l.push("/admin/login")},[r,s,l]),s)?(0,n.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:(0,n.jsxs)("div",{className:"text-center",children:[(0,n.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),(0,n.jsx)("p",{className:"mt-4 text-gray-600",children:"読み込み中..."})]})}):r?(0,n.jsx)(n.Fragment,{children:t}):null}},4126:function(e,t,r){r.d(t,{Z:function(){return d}});var n=r(7437),a=r(2265),i=r(62),o=r(4257);let s=async(e,t)=>{if(!o.tO)throw Error("Firebase Storage is not initialized");try{let r=(0,i.iH)(o.tO,t),n=await (0,i.KV)(r,e);return await (0,i.Jt)(n.ref)}catch(e){throw console.error("Error uploading image:",e),e}},l=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"images",r=Date.now(),n=Math.random().toString(36).substring(2,15),a=e.name.split(".").pop();return"".concat(t,"/").concat(r,"_").concat(n,".").concat(a)};function d(e){let{value:t,onChange:r,label:i}=e,[o,d]=(0,a.useState)(!1),[c,u]=(0,a.useState)(t),h=(0,a.useRef)(null),m=async e=>{var t;let n=null===(t=e.target.files)||void 0===t?void 0:t[0];if(!n)return;let a=new FileReader;a.onloadend=()=>{u(a.result)},a.readAsDataURL(n),d(!0);try{let e=l(n,"articles"),t=await s(n,e);r(t)}catch(e){console.error("Error uploading image:",e),alert("画像のアップロードに失敗しました")}finally{d(!1)}};return(0,n.jsxs)("div",{children:[i&&(0,n.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:i}),c?(0,n.jsxs)("div",{className:"relative inline-block",children:[(0,n.jsx)("img",{src:c,alt:"Preview",className:"w-full max-w-md h-auto rounded-lg border border-gray-300"}),(0,n.jsx)("button",{type:"button",onClick:()=>{u(void 0),r(""),h.current&&(h.current.value="")},className:"absolute top-2 right-2 bg-red-600 text-white px-3 py-1 rounded hover:bg-red-700",children:"削除"})]}):(0,n.jsx)("div",{className:"mt-1 flex justify-center px-6 pt-5 pb-6 border-2 border-gray-300 border-dashed rounded-lg hover:border-blue-500 transition-colors",children:(0,n.jsxs)("div",{className:"space-y-1 text-center",children:[(0,n.jsx)("svg",{className:"mx-auto h-12 w-12 text-gray-400",stroke:"currentColor",fill:"none",viewBox:"0 0 48 48",children:(0,n.jsx)("path",{d:"M28 8H12a4 4 0 00-4 4v20m32-12v8m0 0v8a4 4 0 01-4 4H12a4 4 0 01-4-4v-4m32-4l-3.172-3.172a4 4 0 00-5.656 0L28 28M8 32l9.172-9.172a4 4 0 015.656 0L28 28m0 0l4 4m4-24h8m-4-4v8m-12 4h.02",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"})}),(0,n.jsxs)("div",{className:"flex text-sm text-gray-600",children:[(0,n.jsxs)("label",{htmlFor:"file-upload",className:"relative cursor-pointer bg-white rounded-md font-medium text-blue-600 hover:text-blue-500 focus-within:outline-none",children:[(0,n.jsx)("span",{children:"ファイルを選択"}),(0,n.jsx)("input",{ref:h,id:"file-upload",name:"file-upload",type:"file",className:"sr-only",accept:"image/*",onChange:m,disabled:o})]}),(0,n.jsx)("p",{className:"pl-1",children:"またはドラッグ&ドロップ"})]}),(0,n.jsx)("p",{className:"text-xs text-gray-500",children:"PNG, JPG, GIF up to 10MB"})]})}),o&&(0,n.jsx)("div",{className:"mt-2 text-center text-sm text-gray-600",children:"アップロード中..."})]})}},8756:function(e,t,r){r.d(t,{Z:function(){return i}});var n=r(7437),a=r(2265);function i(e){let{value:t,onChange:r,placeholder:i}=e,o=(0,a.useRef)(null);(0,a.useEffect)(()=>{o.current&&!o.current.hasAttribute("data-initialized")&&(o.current.setAttribute("data-initialized","true"),o.current.innerHTML=t)},[]);let s=()=>{o.current&&r(o.current.innerHTML)},l=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;document.execCommand(e,!1,t),s()},d=e=>{let t=window.getSelection();if(t&&o.current){let r=t.getRangeAt(0),n=document.createTextNode(e);r.insertNode(n),r.setStartAfter(n),r.setEndAfter(n),t.removeAllRanges(),t.addRange(r),s()}};return(0,n.jsxs)("div",{className:"border border-gray-300 rounded-lg overflow-hidden",children:[(0,n.jsxs)("div",{className:"bg-gray-50 border-b border-gray-300 p-2 flex flex-wrap gap-2",children:[(0,n.jsx)("button",{type:"button",onClick:()=>l("bold"),className:"px-3 py-1 bg-white border border-gray-300 rounded hover:bg-gray-100",title:"太字",children:(0,n.jsx)("strong",{children:"B"})}),(0,n.jsx)("button",{type:"button",onClick:()=>l("italic"),className:"px-3 py-1 bg-white border border-gray-300 rounded hover:bg-gray-100",title:"斜体",children:(0,n.jsx)("em",{children:"I"})}),(0,n.jsx)("button",{type:"button",onClick:()=>l("underline"),className:"px-3 py-1 bg-white border border-gray-300 rounded hover:bg-gray-100",title:"下線",children:(0,n.jsx)("u",{children:"U"})}),(0,n.jsx)("div",{className:"w-px bg-gray-300"}),(0,n.jsx)("button",{type:"button",onClick:()=>l("formatBlock","<h2>"),className:"px-3 py-1 bg-white border border-gray-300 rounded hover:bg-gray-100 text-sm",title:"見出し2",children:"H2"}),(0,n.jsx)("button",{type:"button",onClick:()=>l("formatBlock","<h3>"),className:"px-3 py-1 bg-white border border-gray-300 rounded hover:bg-gray-100 text-sm",title:"見出し3",children:"H3"}),(0,n.jsx)("button",{type:"button",onClick:()=>l("formatBlock","<h4>"),className:"px-3 py-1 bg-white border border-gray-300 rounded hover:bg-gray-100 text-sm",title:"見出し4",children:"H4"}),(0,n.jsx)("button",{type:"button",onClick:()=>l("formatBlock","<p>"),className:"px-3 py-1 bg-white border border-gray-300 rounded hover:bg-gray-100 text-sm",title:"段落",children:"P"}),(0,n.jsx)("div",{className:"w-px bg-gray-300"}),(0,n.jsx)("button",{type:"button",onClick:()=>l("insertUnorderedList"),className:"px-3 py-1 bg-white border border-gray-300 rounded hover:bg-gray-100",title:"箇条書き",children:"●"}),(0,n.jsx)("button",{type:"button",onClick:()=>l("insertOrderedList"),className:"px-3 py-1 bg-white border border-gray-300 rounded hover:bg-gray-100",title:"番号付きリスト",children:"1."}),(0,n.jsx)("div",{className:"w-px bg-gray-300"}),(0,n.jsx)("button",{type:"button",onClick:()=>{let e=prompt("リンクURL:");e&&l("createLink",e)},className:"px-3 py-1 bg-white border border-gray-300 rounded hover:bg-gray-100 text-sm",title:"リンク",children:"\uD83D\uDD17"}),(0,n.jsx)("button",{type:"button",onClick:()=>{let e=prompt("画像URL:");e&&l("insertImage",e)},className:"px-3 py-1 bg-white border border-gray-300 rounded hover:bg-gray-100 text-sm",title:"画像",children:"\uD83D\uDDBC️"}),(0,n.jsx)("div",{className:"w-px bg-gray-300"}),(0,n.jsxs)("select",{onChange:e=>{e.target.value&&(d(e.target.value),e.target.value="")},className:"px-3 py-1 bg-white border border-gray-300 rounded hover:bg-gray-100 text-sm",children:[(0,n.jsx)("option",{value:"",children:"ショートコード"}),(0,n.jsx)("option",{value:'[button text="ボタン" url="#"]',children:"ボタン"}),(0,n.jsx)("option",{value:"[quote]引用文[/quote]",children:"引用"}),(0,n.jsx)("option",{value:"[reference]参照元[/reference]",children:"参照"}),(0,n.jsx)("option",{value:"[table]<br/>列1 | 列2 | 列3<br/>---<br/>データ1 | データ2 | データ3<br/>[/table]",children:"表"})]})]}),(0,n.jsx)("div",{ref:o,contentEditable:!0,onInput:s,className:"min-h-[400px] p-4 focus:outline-none prose prose-sm max-w-none",style:{whiteSpace:"pre-wrap"},"data-placeholder":i||"本文を入力..."})]})}},6281:function(e,t,r){r.d(t,{H:function(){return l},a:function(){return s}});var n=r(7437),a=r(2265),i=r(4114);let o=(0,a.createContext)({user:null,loading:!0}),s=()=>{let e=(0,a.useContext)(o);if(!e)throw Error("useAuth must be used within an AuthProvider");return e},l=e=>{let{children:t}=e,[r,s]=(0,a.useState)(null),[l,d]=(0,a.useState)(!0);return(0,a.useEffect)(()=>{let e=(0,i.yv)(e=>{s(e),d(!1)});return()=>e()},[]),(0,n.jsx)(o.Provider,{value:{user:r,loading:l},children:t})}},5522:function(e,t,r){r.d(t,{Vr:function(){return l},Xc:function(){return o},jX:function(){return s},tu:function(){return i},zC:function(){return d}});var n=r(5978),a=r(4257);let i=async e=>{if(!a.db)throw Error("Firestore is not initialized");try{let t=n.EK.now();return(await (0,n.ET)((0,n.hJ)(a.db,"articles"),{...e,publishedAt:t,updatedAt:t,viewCount:0,likeCount:0})).id}catch(e){throw console.error("Error creating article:",e),e}},o=async(e,t)=>{if(!a.db)throw Error("Firestore is not initialized");try{let r=(0,n.JU)(a.db,"articles",e);await (0,n.r7)(r,{...t,updatedAt:(0,n.Bt)()})}catch(e){throw console.error("Error updating article:",e),e}},s=async e=>{if(!a.db)throw Error("Firestore is not initialized");try{let t=(0,n.JU)(a.db,"articles",e);await (0,n.oe)(t)}catch(e){throw console.error("Error deleting article:",e),e}},l=async e=>{if(!a.db)throw Error("Firestore is not initialized");try{var t,r;let i=(0,n.JU)(a.db,"articles",e),o=await (0,n.QT)(i);if(!o.exists())return null;let s=o.data();return{id:o.id,...s,publishedAt:(null===(t=s.publishedAt)||void 0===t?void 0:t.toDate())||new Date,updatedAt:(null===(r=s.updatedAt)||void 0===r?void 0:r.toDate())||new Date}}catch(e){throw console.error("Error getting article:",e),e}},d=async()=>{if(!a.db)throw Error("Firestore is not initialized");try{let e=(0,n.hJ)(a.db,"articles"),t=(0,n.IO)(e,(0,n.Xo)("updatedAt","desc"));return(await (0,n.PL)(t)).docs.map(e=>{var t,r;let n=e.data();return{id:e.id,...n,publishedAt:(null===(t=n.publishedAt)||void 0===t?void 0:t.toDate())||new Date,updatedAt:(null===(r=n.updatedAt)||void 0===r?void 0:r.toDate())||new Date}})}catch(e){throw console.error("Error getting all articles:",e),e}}},4114:function(e,t,r){r.d(t,{w7:function(){return o},yv:function(){return s},zB:function(){return i}});var n=r(3301),a=r(4257);let i=async(e,t)=>{if(!a.I8)throw Error("Firebase Auth is not initialized");try{return(await (0,n.e5)(a.I8,e,t)).user}catch(e){throw console.error("Sign in error:",e),e}},o=async()=>{if(!a.I8)throw Error("Firebase Auth is not initialized");try{await (0,n.w7)(a.I8)}catch(e){throw console.error("Sign out error:",e),e}},s=e=>a.I8?(0,n.Aj)(a.I8,e):(console.warn("Firebase Auth is not initialized"),()=>{})},1424:function(e,t,r){r.d(t,{CP:function(){return i},tG:function(){return o}});var n=r(5978),a=r(4257);let i=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};try{if(!a.db)return console.error("Firestore is not initialized"),[];let t=(0,n.hJ)(a.db,"categories"),r=(0,n.IO)(t);return e.isRecommended&&(r=(0,n.IO)(r,(0,n.ar)("isRecommended","==",!0))),r=(0,n.IO)(r,(0,n.Xo)("order","asc")),(await (0,n.PL)(r)).docs.map(e=>{let t=e.data();return{id:e.id,...t}})}catch(e){return console.error("Error getting categories:",e),[]}},o=i},4257:function(e,t,r){let n,a,i,o;r.d(t,{I8:function(){return o},db:function(){return a},tO:function(){return i}});var s=r(738),l=r(5978),d=r(62),c=r(3301),u=r(257);{let e=["NEXT_PUBLIC_FIREBASE_API_KEY","NEXT_PUBLIC_FIREBASE_AUTH_DOMAIN","NEXT_PUBLIC_FIREBASE_PROJECT_ID","NEXT_PUBLIC_FIREBASE_STORAGE_BUCKET","NEXT_PUBLIC_FIREBASE_MESSAGING_SENDER_ID","NEXT_PUBLIC_FIREBASE_APP_ID"].filter(e=>!u.env[e]);e.length>0&&console.warn("Missing Firebase environment variables:",e.join(", "))}n=(0,s.C6)().length?(0,s.C6)()[0]:(0,s.ZF)({apiKey:"AIzaSyDi8DiIdhLCJO9bXAzBGdeKwBBi7gYPXHs",authDomain:"ayumi-f6bd2.firebaseapp.com",projectId:"ayumi-f6bd2",storageBucket:"ayumi-f6bd2.firebasestorage.app",messagingSenderId:"561071971625",appId:"1:561071971625:web:0e382383fbb444c0066b38"}),a=(0,l.ad)(n),i=(0,d.cF)(n),o=(0,c.v0)(n)},6797:function(e,t,r){r.d(t,{NJ:function(){return i},Ys:function(){return o}});var n=r(5978),a=r(4257);let i=async()=>{try{if(!a.db)return console.error("Firestore is not initialized"),[];let e=(0,n.hJ)(a.db,"tags"),t=(0,n.IO)(e,(0,n.Xo)("name","asc"));return(await (0,n.PL)(t)).docs.map(e=>{let t=e.data();return{id:e.id,...t}})}catch(e){return console.error("Error getting tags:",e),[]}},o=i},7648:function(e,t,r){r.d(t,{default:function(){return a.a}});var n=r(2972),a=r.n(n)},9376:function(e,t,r){var n=r(5475);r.o(n,"usePathname")&&r.d(t,{usePathname:function(){return n.usePathname}}),r.o(n,"useRouter")&&r.d(t,{useRouter:function(){return n.useRouter}}),r.o(n,"useSearchParams")&&r.d(t,{useSearchParams:function(){return n.useSearchParams}})}}]);