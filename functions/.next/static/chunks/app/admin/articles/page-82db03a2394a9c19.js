(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[985],{3284:function(e,t,r){Promise.resolve().then(r.bind(r,2782))},2782:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return c}});var n=r(7437),s=r(2265),a=r(7648),i=r(4906),l=r(206),o=r(5522);function c(){let[e,t]=(0,s.useState)([]),[r,c]=(0,s.useState)(!0),[d,u]=(0,s.useState)("");(0,s.useEffect)(()=>{h()},[]);let h=async()=>{try{c(!0);let e=await (0,o.zC)();t(e)}catch(e){console.error("Error fetching articles:",e)}finally{c(!1)}},x=async(r,n)=>{if(confirm("「".concat(n,"」を削除してもよろしいですか？")))try{await (0,o.jX)(r),t(e.filter(e=>e.id!==r))}catch(e){console.error("Error deleting article:",e),alert("記事の削除に失敗しました")}},m=e.filter(e=>{let t=d.toLowerCase();return e.title.toLowerCase().includes(t)||e.content.toLowerCase().includes(t)});return(0,n.jsx)(i.Z,{children:(0,n.jsx)(l.Z,{children:(0,n.jsxs)("div",{className:"space-y-6",children:[(0,n.jsxs)("div",{className:"flex justify-between items-center",children:[(0,n.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"記事管理"}),(0,n.jsxs)(a.default,{href:"/admin/articles/new",className:"bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700 transition-colors flex items-center",children:[(0,n.jsx)("span",{className:"mr-2",children:"✏️"}),"新規記事を作成"]})]}),(0,n.jsx)("div",{className:"bg-white shadow rounded-lg p-4",children:(0,n.jsx)("input",{type:"text",placeholder:"記事を検索...",value:d,onChange:e=>u(e.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})}),(0,n.jsx)("div",{className:"bg-white shadow rounded-lg overflow-hidden",children:r?(0,n.jsxs)("div",{className:"p-8 text-center",children:[(0,n.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),(0,n.jsx)("p",{className:"mt-4 text-gray-600",children:"読み込み中..."})]}):0===m.length?(0,n.jsx)("div",{className:"p-8 text-center text-gray-500",children:d?"検索結果がありません":"記事がまだありません"}):(0,n.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,n.jsx)("thead",{className:"bg-gray-50",children:(0,n.jsxs)("tr",{children:[(0,n.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"タイトル"}),(0,n.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"ステータス"}),(0,n.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"更新日"}),(0,n.jsx)("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"操作"})]})}),(0,n.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:m.map(e=>{var t;return(0,n.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,n.jsx)("td",{className:"px-6 py-4",children:(0,n.jsxs)("div",{className:"flex items-center",children:[e.featuredImage&&(0,n.jsx)("img",{src:e.featuredImage,alt:"",className:"w-16 h-16 object-cover rounded mr-4"}),(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{className:"text-sm font-medium text-gray-900",children:e.title}),(0,n.jsxs)("div",{className:"text-sm text-gray-500",children:[null===(t=e.excerpt)||void 0===t?void 0:t.substring(0,100),"..."]})]})]})}),(0,n.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,n.jsx)("span",{className:"px-2 py-1 inline-flex text-xs leading-5 font-semibold rounded-full ".concat(e.isPublished?"bg-green-100 text-green-800":"bg-yellow-100 text-yellow-800"),children:e.isPublished?"公開中":"下書き"})}),(0,n.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:new Date(e.updatedAt).toLocaleDateString("ja-JP")}),(0,n.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:(0,n.jsxs)("div",{className:"flex justify-end space-x-2",children:[(0,n.jsx)(a.default,{href:"/admin/articles/".concat(e.id,"/edit"),className:"text-blue-600 hover:text-blue-900",children:"編集"}),(0,n.jsx)(a.default,{href:"/media/articles/".concat(e.slug),target:"_blank",className:"text-green-600 hover:text-green-900",children:"プレビュー"}),(0,n.jsx)("button",{onClick:()=>x(e.id,e.title),className:"text-red-600 hover:text-red-900",children:"削除"})]})})]},e.id)})})]})})]})})})}},206:function(e,t,r){"use strict";r.d(t,{Z:function(){return c}});var n=r(7437),s=r(2265),a=r(7648),i=r(9376),l=r(6281),o=r(4114);function c(e){let{children:t}=e,r=(0,i.usePathname)(),c=(0,i.useRouter)(),{user:d}=(0,l.a)(),[u,h]=(0,s.useState)(!1),x=async()=>{try{await (0,o.w7)(),c.push("/admin/login")}catch(e){console.error("Sign out error:",e)}},m=[{name:"ダッシュボード",href:"/admin",icon:(0,n.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"})})},{name:"記事管理",href:"/admin/articles",icon:(0,n.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),subItems:[{name:"記事一覧",href:"/admin/articles"},{name:"新規記事",href:"/admin/articles/new"}]},{name:"カテゴリー管理",href:"/admin/categories",icon:(0,n.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-6l-2-2H5a2 2 0 00-2 2z"})})},{name:"タグ管理",href:"/admin/tags",icon:(0,n.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z"})})}];return(0,n.jsxs)("div",{className:"min-h-screen bg-gray-100",children:[(0,n.jsx)("header",{className:"fixed top-0 left-0 right-0 bg-white shadow-sm z-50",children:(0,n.jsxs)("div",{className:"flex justify-between items-center px-4 py-3",children:[(0,n.jsxs)("div",{className:"flex items-center",children:[(0,n.jsx)("button",{onClick:()=>h(!u),className:"p-2 rounded-md text-gray-600 hover:text-gray-900 hover:bg-gray-100 lg:hidden",children:(0,n.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})}),(0,n.jsx)(a.default,{href:"/admin",className:"ml-2 lg:ml-0 text-xl font-bold text-blue-600",children:"ふらっと。管理画面"})]}),(0,n.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,n.jsx)("span",{className:"hidden sm:block text-sm text-gray-600",children:null==d?void 0:d.email}),(0,n.jsx)("button",{onClick:x,className:"px-4 py-2 text-sm font-medium text-white bg-red-600 rounded-md hover:bg-red-700",children:"ログアウト"})]})]})}),(0,n.jsx)("aside",{className:"\n        fixed top-[57px] left-0 bottom-0 w-64 bg-white shadow-lg transform transition-transform duration-200 ease-in-out z-40\n        ".concat(u?"translate-x-0":"-translate-x-full","\n        lg:translate-x-0\n      "),children:(0,n.jsx)("nav",{className:"h-full overflow-y-auto py-4",children:m.map(e=>{let t=r===e.href||r.startsWith(e.href+"/");return(0,n.jsxs)("div",{children:[(0,n.jsxs)(a.default,{href:e.href,onClick:()=>h(!1),className:"\n                    flex items-center px-4 py-3 text-sm font-medium transition-colors\n                    ".concat(t?"bg-blue-50 text-blue-700 border-l-4 border-blue-700":"text-gray-700 hover:bg-gray-50 border-l-4 border-transparent","\n                  "),children:[(0,n.jsx)("span",{className:"mr-3",children:e.icon}),e.name]}),e.subItems&&t&&(0,n.jsx)("div",{className:"bg-gray-50",children:e.subItems.map(e=>(0,n.jsx)(a.default,{href:e.href,onClick:()=>h(!1),className:"\n                          flex items-center px-4 py-2 pl-14 text-sm transition-colors\n                          ".concat(r===e.href?"text-blue-700 font-medium":"text-gray-600 hover:text-gray-900","\n                        "),children:e.name},e.href))})]},e.name)})})}),u&&(0,n.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-30 lg:hidden",onClick:()=>h(!1)}),(0,n.jsx)("main",{className:"pt-[57px] lg:ml-64 min-h-screen",children:(0,n.jsx)("div",{className:"p-4 sm:p-6 lg:p-8",children:t})})]})}},4906:function(e,t,r){"use strict";r.d(t,{Z:function(){return l}});var n=r(7437),s=r(2265),a=r(9376),i=r(6281);function l(e){let{children:t}=e,{user:r,loading:l}=(0,i.a)(),o=(0,a.useRouter)();return((0,s.useEffect)(()=>{l||r||o.push("/admin/login")},[r,l,o]),l)?(0,n.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:(0,n.jsxs)("div",{className:"text-center",children:[(0,n.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),(0,n.jsx)("p",{className:"mt-4 text-gray-600",children:"読み込み中..."})]})}):r?(0,n.jsx)(n.Fragment,{children:t}):null}},6281:function(e,t,r){"use strict";r.d(t,{H:function(){return o},a:function(){return l}});var n=r(7437),s=r(2265),a=r(4114);let i=(0,s.createContext)({user:null,loading:!0}),l=()=>{let e=(0,s.useContext)(i);if(!e)throw Error("useAuth must be used within an AuthProvider");return e},o=e=>{let{children:t}=e,[r,l]=(0,s.useState)(null),[o,c]=(0,s.useState)(!0);return(0,s.useEffect)(()=>{let e=(0,a.yv)(e=>{l(e),c(!1)});return()=>e()},[]),(0,n.jsx)(i.Provider,{value:{user:r,loading:o},children:t})}},5522:function(e,t,r){"use strict";r.d(t,{Vr:function(){return o},Xc:function(){return i},jX:function(){return l},tu:function(){return a},zC:function(){return c}});var n=r(5978),s=r(4257);let a=async e=>{if(!s.db)throw Error("Firestore is not initialized");try{let t=n.EK.now();return(await (0,n.ET)((0,n.hJ)(s.db,"articles"),{...e,publishedAt:t,updatedAt:t,viewCount:0,likeCount:0})).id}catch(e){throw console.error("Error creating article:",e),e}},i=async(e,t)=>{if(!s.db)throw Error("Firestore is not initialized");try{let r=(0,n.JU)(s.db,"articles",e);await (0,n.r7)(r,{...t,updatedAt:(0,n.Bt)()})}catch(e){throw console.error("Error updating article:",e),e}},l=async e=>{if(!s.db)throw Error("Firestore is not initialized");try{let t=(0,n.JU)(s.db,"articles",e);await (0,n.oe)(t)}catch(e){throw console.error("Error deleting article:",e),e}},o=async e=>{if(!s.db)throw Error("Firestore is not initialized");try{var t,r;let a=(0,n.JU)(s.db,"articles",e),i=await (0,n.QT)(a);if(!i.exists())return null;let l=i.data();return{id:i.id,...l,publishedAt:(null===(t=l.publishedAt)||void 0===t?void 0:t.toDate())||new Date,updatedAt:(null===(r=l.updatedAt)||void 0===r?void 0:r.toDate())||new Date}}catch(e){throw console.error("Error getting article:",e),e}},c=async()=>{if(!s.db)throw Error("Firestore is not initialized");try{let e=(0,n.hJ)(s.db,"articles"),t=(0,n.IO)(e,(0,n.Xo)("updatedAt","desc"));return(await (0,n.PL)(t)).docs.map(e=>{var t,r;let n=e.data();return{id:e.id,...n,publishedAt:(null===(t=n.publishedAt)||void 0===t?void 0:t.toDate())||new Date,updatedAt:(null===(r=n.updatedAt)||void 0===r?void 0:r.toDate())||new Date}})}catch(e){throw console.error("Error getting all articles:",e),e}}},4114:function(e,t,r){"use strict";r.d(t,{w7:function(){return i},yv:function(){return l},zB:function(){return a}});var n=r(3301),s=r(4257);let a=async(e,t)=>{if(!s.I8)throw Error("Firebase Auth is not initialized");try{return(await (0,n.e5)(s.I8,e,t)).user}catch(e){throw console.error("Sign in error:",e),e}},i=async()=>{if(!s.I8)throw Error("Firebase Auth is not initialized");try{await (0,n.w7)(s.I8)}catch(e){throw console.error("Sign out error:",e),e}},l=e=>s.I8?(0,n.Aj)(s.I8,e):(console.warn("Firebase Auth is not initialized"),()=>{})},4257:function(e,t,r){"use strict";let n,s,a,i;r.d(t,{I8:function(){return i},db:function(){return s},tO:function(){return a}});var l=r(738),o=r(5978),c=r(62),d=r(3301),u=r(257);{let e=["NEXT_PUBLIC_FIREBASE_API_KEY","NEXT_PUBLIC_FIREBASE_AUTH_DOMAIN","NEXT_PUBLIC_FIREBASE_PROJECT_ID","NEXT_PUBLIC_FIREBASE_STORAGE_BUCKET","NEXT_PUBLIC_FIREBASE_MESSAGING_SENDER_ID","NEXT_PUBLIC_FIREBASE_APP_ID"].filter(e=>!u.env[e]);e.length>0&&console.warn("Missing Firebase environment variables:",e.join(", "))}n=(0,l.C6)().length?(0,l.C6)()[0]:(0,l.ZF)({apiKey:"AIzaSyDi8DiIdhLCJO9bXAzBGdeKwBBi7gYPXHs",authDomain:"ayumi-f6bd2.firebaseapp.com",projectId:"ayumi-f6bd2",storageBucket:"ayumi-f6bd2.firebasestorage.app",messagingSenderId:"561071971625",appId:"1:561071971625:web:0e382383fbb444c0066b38"}),s=(0,o.ad)(n),a=(0,c.cF)(n),i=(0,d.v0)(n)},7648:function(e,t,r){"use strict";r.d(t,{default:function(){return s.a}});var n=r(2972),s=r.n(n)},9376:function(e,t,r){"use strict";var n=r(5475);r.o(n,"usePathname")&&r.d(t,{usePathname:function(){return n.usePathname}}),r.o(n,"useRouter")&&r.d(t,{useRouter:function(){return n.useRouter}}),r.o(n,"useSearchParams")&&r.d(t,{useSearchParams:function(){return n.useSearchParams}})}},function(e){e.O(0,[358,139,972,933,971,117,744],function(){return e(e.s=3284)}),_N_E=e.O()}]);