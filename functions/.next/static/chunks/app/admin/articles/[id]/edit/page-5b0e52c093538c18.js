(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[528],{7064:function(e,s,a){Promise.resolve().then(a.bind(a,6462))},6462:function(e,s,a){"use strict";a.r(s),a.d(s,{default:function(){return g}});var t=a(7437),l=a(2265),r=a(9376),n=a(4906),i=a(206),d=a(8756),c=a(4126),o=a(5522),u=a(1424),m=a(6797);function g(e){let{params:s}=e,a=(0,r.useRouter)(),[g,x]=(0,l.useState)(!1),[h,b]=(0,l.useState)(!0),[p,f]=(0,l.useState)([]),[y,j]=(0,l.useState)([]),[N,v]=(0,l.useState)(null),[w,k]=(0,l.useState)({title:"",content:"",excerpt:"",slug:"",authorName:"",categoryIds:[],tagIds:[],featuredImage:"",isPublished:!1,metaTitle:"",metaDescription:"",googleMapsUrl:"",reservationUrl:""});(0,l.useEffect)(()=>{(async()=>{try{let[e,t,l]=await Promise.all([(0,o.Vr)(s.id),(0,u.tG)(),(0,m.Ys)()]);if(!e){alert("記事が見つかりません"),a.push("/admin/articles");return}v(e),k({title:e.title,content:e.content,excerpt:e.excerpt||"",slug:e.slug,authorName:e.authorName,categoryIds:e.categoryIds,tagIds:e.tagIds,featuredImage:e.featuredImage||"",isPublished:e.isPublished,metaTitle:e.metaTitle||"",metaDescription:e.metaDescription||"",googleMapsUrl:e.googleMapsUrl||"",reservationUrl:e.reservationUrl||""}),f(t),j(l)}catch(e){console.error("Error fetching data:",e)}finally{b(!1)}})()},[s.id,a]);let I=async e=>{if(e.preventDefault(),!w.title||!w.content||!w.slug||!w.authorName){alert("タイトル、本文、スラッグ、著者名は必須です");return}x(!0);try{await (0,o.Xc)(s.id,w),alert("記事を更新しました"),a.push("/admin/articles")}catch(e){console.error("Error updating article:",e),alert("記事の更新に失敗しました")}finally{x(!1)}};return h?(0,t.jsx)(n.Z,{children:(0,t.jsx)(i.Z,{children:(0,t.jsx)("div",{className:"flex items-center justify-center min-h-[400px]",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),(0,t.jsx)("p",{className:"mt-4 text-gray-600",children:"読み込み中..."})]})})})}):(0,t.jsx)(n.Z,{children:(0,t.jsx)(i.Z,{children:(0,t.jsxs)("div",{className:"max-w-4xl",children:[(0,t.jsx)("div",{className:"mb-6",children:(0,t.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"記事編集"})}),(0,t.jsxs)("form",{onSubmit:I,className:"space-y-6",children:[(0,t.jsxs)("div",{className:"bg-white shadow rounded-lg p-6",children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"タイトル *"}),(0,t.jsx)("input",{type:"text",value:w.title,onChange:e=>k({...w,title:e.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})]}),(0,t.jsxs)("div",{className:"bg-white shadow rounded-lg p-6",children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"スラッグ（URL） *"}),(0,t.jsx)("input",{type:"text",value:w.slug,onChange:e=>k({...w,slug:e.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"article-slug",required:!0}),(0,t.jsxs)("p",{className:"mt-1 text-sm text-gray-500",children:["URL: /media/articles/",w.slug||"article-slug"]})]}),(0,t.jsxs)("div",{className:"bg-white shadow rounded-lg p-6",children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"著者名 *"}),(0,t.jsx)("input",{type:"text",value:w.authorName,onChange:e=>k({...w,authorName:e.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})]}),(0,t.jsxs)("div",{className:"bg-white shadow rounded-lg p-6",children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"抜粋"}),(0,t.jsx)("textarea",{value:w.excerpt,onChange:e=>k({...w,excerpt:e.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",rows:3})]}),(0,t.jsx)("div",{className:"bg-white shadow rounded-lg p-6",children:(0,t.jsx)(c.Z,{label:"アイキャッチ画像",value:w.featuredImage,onChange:e=>k({...w,featuredImage:e})})}),(0,t.jsxs)("div",{className:"bg-white shadow rounded-lg p-6",children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"本文 *"}),(0,t.jsx)(d.Z,{value:w.content,onChange:e=>k({...w,content:e})})]}),(0,t.jsxs)("div",{className:"bg-white shadow rounded-lg p-6 space-y-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"カテゴリー"}),(0,t.jsx)("div",{className:"space-y-2",children:p.map(e=>(0,t.jsxs)("label",{className:"flex items-center",children:[(0,t.jsx)("input",{type:"checkbox",checked:w.categoryIds.includes(e.id),onChange:s=>{s.target.checked?k({...w,categoryIds:[...w.categoryIds,e.id]}):k({...w,categoryIds:w.categoryIds.filter(s=>s!==e.id)})},className:"mr-2"}),e.name]},e.id))})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"タグ"}),(0,t.jsx)("div",{className:"space-y-2",children:y.map(e=>(0,t.jsxs)("label",{className:"inline-flex items-center mr-4",children:[(0,t.jsx)("input",{type:"checkbox",checked:w.tagIds.includes(e.id),onChange:s=>{s.target.checked?k({...w,tagIds:[...w.tagIds,e.id]}):k({...w,tagIds:w.tagIds.filter(s=>s!==e.id)})},className:"mr-2"}),e.name]},e.id))})]})]}),(0,t.jsxs)("div",{className:"bg-white shadow rounded-lg p-6 space-y-4",children:[(0,t.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"SEO設定"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"メタタイトル"}),(0,t.jsx)("input",{type:"text",value:w.metaTitle,onChange:e=>k({...w,metaTitle:e.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"メタディスクリプション"}),(0,t.jsx)("textarea",{value:w.metaDescription,onChange:e=>k({...w,metaDescription:e.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",rows:3})]})]}),(0,t.jsxs)("div",{className:"bg-white shadow rounded-lg p-6 space-y-4",children:[(0,t.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"追加設定"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Googleマップ URL"}),(0,t.jsx)("input",{type:"url",value:w.googleMapsUrl,onChange:e=>k({...w,googleMapsUrl:e.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"予約サイト URL"}),(0,t.jsx)("input",{type:"url",value:w.reservationUrl,onChange:e=>k({...w,reservationUrl:e.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]})]}),(0,t.jsx)("div",{className:"bg-white shadow rounded-lg p-6",children:(0,t.jsxs)("label",{className:"flex items-center",children:[(0,t.jsx)("input",{type:"checkbox",checked:w.isPublished,onChange:e=>k({...w,isPublished:e.target.checked}),className:"mr-2"}),(0,t.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"この記事を公開する"})]})}),(0,t.jsxs)("div",{className:"flex justify-end space-x-4",children:[(0,t.jsx)("button",{type:"button",onClick:()=>a.back(),className:"px-6 py-3 border border-gray-300 rounded-lg hover:bg-gray-50",children:"キャンセル"}),(0,t.jsx)("button",{type:"submit",disabled:g,className:"px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed",children:g?"更新中...":"記事を更新"})]})]})]})})})}}},function(e){e.O(0,[358,139,972,933,713,971,117,744],function(){return e(e.s=7064)}),_N_E=e.O()}]);